"""
특허 분석용 프롬프트 템플릿
- 다양한 특허 분석 작업에 활용 가능한 프롬프트 모음
"""

# ============================================================
# 시스템 프롬프트
# ============================================================

SYSTEM_PROMPTS = {
    "patent_expert": """당신은 특허 분석 전문가입니다.
기술적 내용을 정확하게 분석하고, 특허법 관점에서 객관적인 의견을 제시해주세요.
한국어로 답변해주세요.""",

    "patent_examiner": """당신은 특허청 심사관입니다.
특허 요건(신규성, 진보성, 산업상 이용가능성)을 기준으로 엄격하게 분석해주세요.
한국어로 답변해주세요.""",

    "patent_attorney": """당신은 특허 변리사입니다.
청구항의 권리범위와 법적 해석에 중점을 두고 분석해주세요.
한국어로 답변해주세요.""",

    "tech_analyst": """당신은 기술 분석가입니다.
발명의 기술적 특징과 시장 응용 가능성을 중심으로 분석해주세요.
한국어로 답변해주세요.""",
}


# ============================================================
# 작업별 프롬프트 템플릿
# ============================================================

PROMPT_TEMPLATES = {
    # 1. 기본 요약
    "summary": """다음 특허 텍스트를 분석하고 요약해주세요:

{patent_text}

다음 항목을 포함해주세요:
1. 핵심 기술 요약 (2-3문장)
2. 주요 구성요소
3. 기술적 효과""",

    # 2. 청구항 분석
    "claim_analysis": """다음 특허 청구항을 분석해주세요:

{patent_text}

다음 항목을 포함해주세요:
1. 청구항 유형 (독립항/종속항)
2. 구성요소 분해
3. 권리범위 해석
4. 핵심 한정 요소""",

    # 3. 신규성/진보성 분석
    "patentability": """다음 발명의 특허성을 분석해주세요:

{patent_text}

다음 항목에 대해 의견을 제시해주세요:
1. 신규성 (Novelty)
   - 공지기술과의 차별점
2. 진보성 (Inventive Step)
   - 기술적 난이도
   - 예측 가능성
3. 산업상 이용가능성
4. 종합 의견""",

    # 4. 기술 분류
    "classification": """다음 특허 기술을 분류해주세요:

{patent_text}

다음 정보를 제공해주세요:
1. 기술 분야 (예: 반도체, 배터리, AI 등)
2. IPC 분류 추정 (가능한 경우)
3. 관련 산업
4. 핵심 키워드 (5개)""",

    # 5. 침해 분석
    "infringement": """다음 특허와 대상 제품/기술의 침해 가능성을 분석해주세요:

[특허 청구항]
{patent_text}

[대상 기술/제품]
{target_text}

다음 항목을 분석해주세요:
1. 구성요소 대비표 (Claim Chart)
2. 문언 침해 가능성
3. 균등론 적용 가능성
4. 회피 설계 가능성
5. 종합 의견""",

    # 6. 선행기술 비교
    "prior_art_comparison": """다음 특허와 선행기술을 비교 분석해주세요:

[분석 대상 특허]
{patent_text}

[선행기술]
{prior_art_text}

다음 항목을 분석해주세요:
1. 공통점
2. 차이점
3. 기술적 진보성 여부
4. 종합 의견""",

    # 7. 특허 가치 평가
    "valuation": """다음 특허의 가치를 평가해주세요:

{patent_text}

다음 관점에서 분석해주세요:
1. 기술적 우수성 (1-10점)
2. 시장 적용성 (1-10점)
3. 권리범위 넓이 (1-10점)
4. 회피 설계 난이도 (1-10점)
5. 종합 평가 및 의견""",

    # 8. 영문 초록 번역/작성
    "abstract_english": """다음 특허 내용을 바탕으로 영문 초록(Abstract)을 작성해주세요:

{patent_text}

요구사항:
- 150단어 이내
- 기술적 문제, 해결책, 효과 포함
- 특허 명세서 스타일로 작성""",
}


# ============================================================
# 헬퍼 함수
# ============================================================

def get_prompt(template_name: str, **kwargs) -> str:
    """템플릿 이름과 변수를 받아 완성된 프롬프트 반환"""
    if template_name not in PROMPT_TEMPLATES:
        raise ValueError(f"Unknown template: {template_name}. Available: {list(PROMPT_TEMPLATES.keys())}")

    template = PROMPT_TEMPLATES[template_name]
    return template.format(**kwargs)


def get_system_prompt(role: str = "patent_expert") -> str:
    """역할에 맞는 시스템 프롬프트 반환"""
    return SYSTEM_PROMPTS.get(role, SYSTEM_PROMPTS["patent_expert"])


def list_templates() -> None:
    """사용 가능한 템플릿 목록 출력"""
    print("사용 가능한 프롬프트 템플릿:")
    print("-" * 40)
    for name in PROMPT_TEMPLATES.keys():
        print(f"  - {name}")
    print()
    print("사용 가능한 시스템 프롬프트:")
    print("-" * 40)
    for name in SYSTEM_PROMPTS.keys():
        print(f"  - {name}")


# ============================================================
# 사용 예시
# ============================================================

if __name__ == "__main__":
    # 템플릿 목록 출력
    list_templates()

    # 사용 예시
    sample_patent = """
    이 발명은 리튬 이온 2차 전지의 수명을 향상시키기 위한 전극 구조에 관한 것이다.
    양극 및 음극 사이에 특수한 세퍼레이터 구조를 도입하여 충방전 사이클 시 용량 저하를 최소화한다.
    """

    print("\n[프롬프트 생성 예시]")
    print("=" * 50)

    # 요약 프롬프트
    prompt = get_prompt("summary", patent_text=sample_patent)
    print(prompt)
